<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flow Vision V12.1 - Fixed</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    
    <style>
        /* Ê†∑Âºè‰øùÊåÅ‰∏çÂèòÔºåÁõ¥Êé•ÂµåÂÖ• */
        :root { --neon-green: #0f0; --neon-red: #ff2a2a; --neon-blue: #0ff; --bg-color: #000; }
        body { margin: 0; background-color: var(--bg-color); font-family: 'VT323', monospace; overflow: hidden; color: var(--neon-green); user-select: none; width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center; }
        #webcam { position: absolute; width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); z-index: 0; filter: contrast(1.2) brightness(0.7) grayscale(0.5); }
        #output_canvas { position: absolute; width: 100%; height: 100%; z-index: 10; transform: scaleX(-1); image-rendering: pixelated; }
        #loading { position: absolute; width: 100%; height: 100%; background: #000; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .glitch { font-size: 60px; color: var(--neon-green); text-shadow: 2px 0 var(--neon-red), -2px 0 var(--neon-blue); animation: glitch-anim 1s infinite linear alternate-reverse; }
        .loader-bar { width: 300px; height: 10px; border: 2px solid var(--neon-green); margin: 20px 0; padding: 2px; box-shadow: 0 0 10px rgba(0,255,0,0.5); }
        .bar-fill { height: 100%; background: var(--neon-green); width: 0%; animation: loading-fill 3s forwards; }
        #loading-log { color: #999; font-size: 18px; margin-top: 10px; text-align: center; max-width: 80%; }
        #start-overlay { position: absolute; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 200; display: none; align-items: center; justify-content: center; }
        .cyber-panel { border: 4px solid var(--neon-green); padding: 40px 60px; text-align: center; background: rgba(0, 20, 0, 0.8); box-shadow: 0 0 30px var(--neon-green), inset 0 0 15px rgba(0,255,0,0.3); }
        .cyber-panel h1 { font-size: 48px; margin: 10px 0 20px; letter-spacing: 5px; color: #fff; }
        .cyber-panel p { font-size: 24px; margin-bottom: 10px; color: var(--neon-blue); }
        .start-btn { background: var(--neon-green); color: #000; border: none; padding: 10px 30px; font-family: 'VT323', monospace; font-size: 30px; cursor: pointer; margin-top: 30px; transition: background 0.2s; }
        .start-btn:hover { background: #fff; }
        .ui-layer { position: absolute; width: 100%; height: 100%; z-index: 50; pointer-events: none; }
        .hud-top { position: absolute; top: 20px; left: 20px; display: flex; flex-direction: column; gap: 10px; }
        .hud-bottom { position: absolute; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; text-align: right; }
        .hud-item { font-size: 24px; background: rgba(0,0,0,0.7); padding: 5px 10px; border: 1px solid var(--neon-green); color: #fff; }
        #gravity-val, #music-status { color: var(--neon-blue); }
        #infection-warning { color: var(--neon-red); font-size: 32px; display: none; background: #000; border: 2px solid var(--neon-red); padding: 5px 20px; }
        .blink { animation: blink 0.5s infinite; }
        @keyframes blink { 50% { opacity: 0; } }
        @keyframes glitch-anim { 0% { transform: translate(0) } 20% { transform: translate(-2px, 2px) } 40% { transform: translate(-2px, -2px) } 60% { transform: translate(2px, 2px) } 80% { transform: translate(2px, -2px) } 100% { transform: translate(0) } }
        @keyframes loading-fill { 0% { width: 0%; } 100% { width: 100%; } }
    </style>
</head>
<body>
    <video id="webcam" autoplay playsinline></video>
    <canvas id="output_canvas"></canvas>

    <div id="loading">
        <div class="glitch-wrapper"><div class="glitch">SYSTEM_INIT...</div></div>
        <div class="loader-bar"><div class="bar-fill"></div></div>
        <div id="loading-log">Connecting to Neural Net...</div>
    </div>

    <div id="start-overlay">
        <div class="cyber-panel">
            <h1>NEURAL LINK READY</h1>
            <p>GESTURES: [PINCH] Create | [OPEN] Push | [TILT] Gravity | [FIST] Purge</p>
            <button class="start-btn">>>> START SIMULATION <<<</button>
        </div>
    </div>

    <div class="ui-layer">
        <div class="hud-top">
            <div class="hud-item">GRAVITY: <span id="gravity-val">STABLE</span></div>
            <div id="infection-warning" class="blink">‚ö†Ô∏è BIO-HAZARD DETECTED ‚ö†Ô∏è</div>
        </div>
        <div class="hud-bottom">
            <div class="hud-item">ENTITIES: <span id="particle-count">0</span></div>
            <div class="hud-item">MUSIC: <span id="music-status">OFFLINE</span></div>
        </div>
    </div>

    <!-- üî¥ ÂÖ®Â±ÄÈîôËØØÊçïÊçâËÑöÊú¨ -->
    <script>
        window.onerror = function(message, source, lineno, colno, error) {
            const log = document.getElementById('loading-log');
            const title = document.querySelector('.glitch');
            const bar = document.querySelector('.loader-bar');
            if(log && title) {
                bar.style.display = 'none';
                title.innerText = "CRITICAL ERROR";
                title.style.color = "red";
                log.innerHTML = `<span style="color:red">Failed to load: ${message}</span><br><span style="font-size:14px; color:#666">Please check internet or HTTPS</span>`;
            }
        };
    </script>

    <!-- ÂºïÁî®Ê†∏ÂøÉ JS -->
    <script type="module" src="js/app.js"></script>
</body>
</html>
